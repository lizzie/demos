module.exports = function (grunt) {
    grunt.initConfig({
        transport:{
            capture:{
                options:{
                    paths:['./'],
                    alias:{
                        '$':'libs/jquery/1.8.1/jquery',
                        'jquery':'libs/jquery/1.8.1/jquery',
                        'underscore':'libs/underscore/1.3.3/underscore'
                    }
                },
                files:[
                    {
                        cwd:'capture',
                        src:'*.js',
                        dest:'build/capture'
                    }
                ]
            },
            common:{
                options:{
                    paths:['./'],
                    alias:{
                        '$':'libs/jquery/1.8.1/jquery',
                        'jquery':'libs/jquery/1.8.1/jquery',
                        'underscore':'libs/underscore/1.3.3/underscore',
                        'backbone':'libs/backbone/0.9.9/backbone',
                        'mustache':'libs/mustache/0.5.0/mustache',
                        'info_tpl':'common/tpl',
                        'loader':'common/loader'
                    }
                },
                files:[
                    {
                        cwd:'common',
                        src:'*.js',
                        dest:'build/common'
                    }
                ]
            },
            publish:{
                options:{
                    paths:['./'],
                    alias:{
                        '$':'libs/jquery/1.8.1/jquery',
                        'jquery':'libs/jquery/1.8.1/jquery',
                        'underscore':'libs/underscore/1.3.3/underscore',
                        'backbone':'libs/backbone/0.9.9/backbone',
                        'mustache':'libs/mustache/0.5.0/mustache',
                        'ad':'common/ad',
                        'message':'common/message'
                    }
                },
                files:[
                    {
                        cwd:'publish',
                        src:'*.js',
                        dest:'build/publish'
                    }
                ]
            },
            dashboard:{
                options:{
                    paths:['./'],
                    alias:{
                        '$':'libs/jquery/1.8.1/jquery',
                        'jquery':'libs/jquery/1.8.1/jquery',
                        'underscore':'libs/underscore/1.3.3/underscore',
                        'backbone':'libs/backbone/0.9.9/backbone',
                        'mustache':'libs/mustache/0.5.0/mustache',
                        'bootstrap':'libs/bootstrap/2.2.2/bootstrap',
                        'ad':'common/ad',
                        'publish':'publish',
                        'loading':'common/loading'
                    }
                },
                files:[
                    {
                        cwd:'dashboard',
                        src:'*.js',
                        dest:'build/dashboard'
                    }
                ]
            },
            viewer:{
                options:{
                    paths:['./'],
                    alias:{
                        '$':'libs/jquery/1.8.1/jquery',
                        'jquery':'libs/jquery/1.8.1/jquery',
                        'underscore':'libs/underscore/1.3.3/underscore',
                        'mustache':'libs/mustache/0.5.0/mustache',
                        'backbone':'libs/backbone/0.9.9/backbone',
                        'info_tpl':'common/tpl'
                    }
                },
                files:[
                    {
                        cwd:'viewer',
                        src:'*.js',
                        dest:'build/viewer'
                    }
                ]
            },
            about:{
                options:{
                    paths:['./'],
                    alias:{
                        'jquery':'libs/jquery/1.8.1/jquery',
                        '$':'libs/jquery/1.8.1/jquery'
                    }
                },
                files:[
                    {
                        cwd:'about',
                        src:'*.js',
                        dest:'build/about'
                    }
                ]

            }
        },
        concat:{
            capture:{
                options:{
                    include:'relative'
                },
                files:{
                    "dist/capture.js":["build/capture/index.js"]
                }
            },
            common:{
                options:{
                    include:'relative'
                },
                files:{
                    "dist/common/ad.js":["build/common/ad.js"],
                    "dist/common/loader.js":["build/common/loader.js"],
                    "dist/common/message.js":["build/common/message.js"],
                    "dist/common/loading.js":["build/common/loading.js"],
                    "dist/common/auth.js":["build/common/auth.js"],
                    "dist/common/tpl.js":["build/common/tpl.js"],
                    "dist/common/baidu.js":["build/common/baidu.js"],
                    "dist/common/google.js":["build/common/google.js"],
                    "dist/common/gaode.js":["build/common/gaode.js"]
                }
            },
            publish:{
                options:{
                    include:'relative'
                },
                files:{
                    "dist/publish.js":["build/publish/publish.js"]
                }
            },
            dashboard:{
                options:{
                    include:'relative'
                },
                files:{
                    "dist/dashboard.js":["build/dashboard/index.js"]
                }
            },
            viewer:{
                files:{
                    "dist/viewer/index.js":[
                        "build/viewer/index.js"
                    ],
                    "dist/viewer/google.js":[
                        "build/viewer/google.js"
                    ],
                    "dist/viewer/gaode.js":[
                        "build/viewer/gaode.js"
                    ],
                    "dist/viewer/baidu.js":[
                        "build/viewer/baidu.js"
                    ]
                }
            },
            about:{
                files:{
                    "dist/about.js":[
                        "build/about/index.js"
                    ]
                }
            }
        },
        uglify:{
            main:{
                files:{
                    'dist/capture.js':['dist/capture.js'],
                    'dist/common/ad.js':['dist/common/ad.js'],
                    'dist/common/loader.js':['dist/common/loader.js'],
                    'dist/common/message.js':['dist/common/message.js'],
                    'dist/common/loading.js':['dist/common/loading.js'],
                    'dist/common/auth.js':['dist/common/auth.js'],
                    'dist/common/tpl.js':['dist/common/tpl.js'],
                    'dist/common/baidu.js':['dist/common/baidu.js'],
                    'dist/common/google.js':['dist/common/google.js'],
                    'dist/common/gaode.js':['dist/common/gaode.js'],
                    'dist/publish.js':['dist/publish.js'],
                    'dist/dashboard.js':['dist/dashboard.js'],
                    'dist/viewer/index.js':['dist/viewer/index.js'],
                    'dist/viewer/baidu.js':['dist/viewer/baidu.js'],
                    'dist/viewer/google.js':['dist/viewer/google.js'],
                    'dist/viewer/gaode.js':['dist/viewer/gaode.js'],
                    'dist/about.js':['dist/about.js'],
                    'dist/config.js':['config.js'],
                    'dist/html5.js':['html5.js']
                }
            }
        },
        cssmin:{
            about:{
                src:'css/about.css',
                dest:'dist/css/about.css'
            },
            alice:{
                src:'css/alice_1.0.0.css',
                dest:'dist/css/alice_1.0.0.css'
            },
            bootstrap:{
                src:'css/bootstrap.css',
                dest:'dist/css/bootstrap.css'
            },
            "bootstrap-responsive":{
                src:'css/bootstrap-responsive.css',
                dest:'dist/css/bootstrap-responsive.css'
            },
            capture:{
                src:'css/capture.css',
                dest:'dist/css/capture.css'
            },
            main:{
                src:'css/main.css',
                dest:'dist/css/main.css'
            },
            ie:{
                src:'css/ie.css',
                dest:'dist/css/ie.css'
            }
        },
        copyto:{
            img:{
                cwd:"css/",
                src:'glyphicons-halflings-white.png',
                dest:'dist/css/'
            },
            img2:{
                cwd:"css/",
                src:'glyphicons-halflings.png',
                dest:'dist/css/'
            }
        },
        clean:{
            build:['build']
        }
    });
    grunt.loadNpmTasks('grunt-cmd-transport');
    grunt.loadNpmTasks('grunt-cmd-concat');
    grunt.loadNpmTasks('grunt-contrib-uglify');
    grunt.loadNpmTasks('grunt-css');
    grunt.loadNpmTasks('grunt-copy-to');
    grunt.loadNpmTasks('grunt-contrib-clean');

    grunt.registerTask('default', ['transport', 'concat', 'uglify', 'cssmin', 'copyto', 'clean']);
};